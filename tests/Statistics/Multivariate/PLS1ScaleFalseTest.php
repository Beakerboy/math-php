<?php

namespace MathPHP\Tests\Statistics\Multivariate;

use MathPHP\LinearAlgebra\Matrix;
use MathPHP\LinearAlgebra\MatrixFactory;
use MathPHP\SampleData;
use MathPHP\Statistics\Multivariate\PLS;

class PLS1ScaleFalseTest extends \PHPUnit\Framework\TestCase
{
    /** @var PLS */
    private static $pls;

    /** @var Matrix */
    private static $X;

    /** @var Matrix */
    private static $Y;

    /**
     * R code for expected values:
     *   library(chemometrics)
     *   data(cereal)
     *   pls.model = pls2_nipals(cereal$X, cereal$Y, a=5)
     *
     * @throws Exception\MathException
     */
    public static function setUpBeforeClass(): void
    {
        $cereal   = new SampleData\Cereal();
        self::$X  = MatrixFactory::create($cereal->getXData());
        self::$Y  = MatrixFactory::create($cereal->getYData());

        self::$pls = new PLS(self::$X, self::$Y, 5, false);
    }

    /**
     * @test         Construction
     * @throws       Exception\MathException
     */
    public function testConstruction()
    {
        // When
        $pls = new PLS(self::$X, self::$Y, 5, false);

        // Then
        $this->assertInstanceOf(PLS::class, $pls);
    }

    /**
     * @test The class returns the correct values for T
     *
     * R code for expected values:
     *   pls.model$T
     */
    public function testT()
    {
        // Given
        $expected = [
            [-0.0001868638, -0.0002046034, 0.0046609248, -0.0001600709, 0.00004982759],
            [-0.0016778554, 0.00005917951, 0.0052769064, -0.0006910983, 0.0004655183],
            [-0.0051548113, -0.000447606, 0.0011327825, 0.0004474364, -0.000007108459],
            [0.0145545101, 0.0005525388, -0.0042893817, 0.0004234981, 0.0009071037],
            [0.0130044547, 0.001629171, -0.0007747091, -0.001552795, 0.0008151882],
            [0.0190486865, 0.002853815, -0.0011286369, -0.0008433846, -0.0004428237],
            [-0.0241767255, -0.001024907, -0.0023870719, -0.000895506, 0.0009098762],
            [-0.0115948395, -0.0003388141, -0.0008535249, -0.001196682, -0.001003641],
            [-0.0227801577, -0.0008897606, -0.0033519487, 0.00004398769, 0.0004707373],
            [0.0116569657, -0.002063344, 0.0004043838, -0.001575964, -0.000555956],
            [0.020761095, -0.00165762, 0.0008174193, 0.00006268997, -0.001051075],
            [-0.0127461466, 0.0006911177, -0.0030157056, 0.0005838427, -0.0004274284],
            [-0.0222939597, 0.001663128, 0.0050029883, 0.00116166, 0.0000582372],
            [-0.00147144, 0.0004688227, -0.002098463, 0.002020786, -0.001425581],
            [0.0230570875, -0.001291118, 0.0006040369, 0.002171599, 0.001237125],
        ];

        // When
        $T = self::$pls->getXScores()->getMatrix();

        // Then
        $this->assertEqualsWithDelta($expected, $T, .00001, '');
    }

    /**
     * @test The class returns the correct values for W
     *
     * R code for expected values:
     *   pls.model$W
     */
    public function testW()
    {
        // Given
        $expected = [
            [0.0734291936, 0.075494873, -0.07962752, -0.0991457361, 0.0185171419],
            [0.0892686597, 0.084473465, -0.1127286, -0.1365435312, -0.0176498597],
            [0.0974581612, 0.088332581, -0.1287691, -0.1560144902, -0.0487064718],
            [0.0982980659, 0.088679592, -0.1257427, -0.1471835056, -0.0566276198],
            [0.0932582064, 0.08755351, -0.1125333, -0.1276608447, -0.062074792],
            [0.083935107, 0.084074163, -0.09434272, -0.1022785269, -0.0531962013],
            [0.0717861972, 0.080785526, -0.0754114, -0.0752361679, -0.0317767519],
            [0.0564547084, 0.076293373, -0.05392677, -0.0486804428, -0.0003315844],
            [0.0342801754, 0.055114963, -0.03009046, -0.0283350103, 0.0188528805],
            [0.0051755787, 0.011374032, -0.004623049, -0.0241674056, -0.0008129216],
            [-0.0249559994, -0.044928302, 0.02023768, -0.0207772221, -0.0291625869],
            [-0.047249076, -0.091188641, 0.03862492, -0.0195085463, -0.0591948108],
            [-0.0570183961, -0.114887066, 0.04721758, -0.0206189599, -0.0739206142],
            [-0.0540608616, -0.110269236, 0.04812857, -0.018392109, -0.0606979815],
            [-0.0423090386, -0.084893256, 0.04428089, -0.0123256, -0.0283547526],
            [-0.0278503015, -0.05212947, 0.03857857, -0.0043326936, 0.0092310907],
            [-0.0164422686, -0.02682368, 0.03308704, -0.0022953127, 0.0268540255],
            [-0.0099516813, -0.013655314, 0.02949484, -0.0014351622, 0.0328966545],
            [-0.0072966086, -0.011876062, 0.02760579, -0.0017786045, 0.0318196161],
            [-0.00489996, -0.01233647, 0.02670553, -0.0014160963, 0.0363670274],
            [-0.0005196826, -0.010317084, 0.02318916, -0.0057241907, 0.0400761918],
            [0.0063721714, -0.008349051, 0.01511423, -0.0165365073, 0.0328595551],
            [0.016709234, -0.004474031, 0.002936339, -0.0337741804, 0.0200435275],
            [0.0307736152, 0.003512388, -0.01292375, -0.0553133615, 0.0010493804],
            [0.0472873321, 0.016687569, -0.03019209, -0.0779703691, -0.0260145151],
            [0.064046451, 0.03370313, -0.04276724, -0.0903051936, -0.0467713595],
            [0.079186419, 0.054041371, -0.04717635, -0.0874471834, -0.0528755357],
            [0.0908738628, 0.074759744, -0.04634188, -0.0771151977, -0.0509725576],
            [0.0988677214, 0.093343685, -0.0421365, -0.064729227, -0.0395171013],
            [0.1054065648, 0.10668808, -0.03450237, -0.0542116389, -0.0215019345],
            [0.1157522518, 0.113391641, -0.02697749, -0.0558662343, -0.0059630096],
            [0.1338489794, 0.110315553, -0.02362988, -0.074862807, -0.0032697251],
            [0.1614583209, 0.102458087, -0.02661343, -0.0994672395, -0.013072058],
            [0.1945841618, 0.095230225, -0.03543942, -0.1122939437, -0.040613067],
            [0.222921213, 0.085020556, -0.05230637, -0.1091239881, -0.0843599019],
            [0.2366489948, 0.073667929, -0.07328986, -0.0822778341, -0.1033759532],
            [0.2282272597, 0.056093051, -0.09002989, -0.0364351076, -0.0977300882],
            [0.1970405588, 0.027039937, -0.09593007, 0.000133856, -0.0967415997],
            [0.1516202077, -0.00688854, -0.08697914, 0.017341027, -0.0899662683],
            [0.103744451, -0.036631193, -0.06574509, 0.0184011668, -0.0642627691],
            [0.0628008611, -0.050988831, -0.03650629, 0.0132840752, -0.0307380903],
            [0.0327153902, -0.046960997, -0.006122613, 0.0073512444, -0.0046087531],
            [0.0137150705, -0.024400173, 0.02165262, 0.0159392009, 0.0346546338],
            [0.001604044, 0.004564669, 0.04108197, 0.0330224688, 0.0761993905],
            [-0.0084975252, 0.02286459, 0.05107148, 0.0443441052, 0.0946472688],
            [-0.0170939888, 0.030149721, 0.05187104, 0.0443056428, 0.0889575765],
            [-0.0243135898, 0.024842092, 0.04191145, 0.0316200478, 0.0701487974],
            [-0.0297346711, 0.010908754, 0.0244106, 0.0107799084, 0.0532020772],
            [-0.032322075, -0.003797749, 0.003814019, -0.0138719995, 0.0402027741],
            [-0.0322299704, -0.015534321, -0.0154572, -0.0319995338, 0.0311446733],
            [-0.031022367, -0.025843393, -0.03146223, -0.0471712452, 0.0181355733],
            [-0.0285154046, -0.031649904, -0.03982021, -0.054133258, 0.0094616403],
            [-0.0251017169, -0.031493259, -0.03981183, -0.0498236953, 0.0111996703],
            [-0.0224073882, -0.027601519, -0.03425867, -0.041755306, 0.0154633488],
            [-0.0218947549, -0.024085434, -0.02559319, -0.0380336611, 0.0163796822],
            [-0.0241590379, -0.020674365, -0.01467368, -0.0367333863, 0.0169315971],
            [-0.0293929459, -0.018831412, -0.004121736, -0.0369800284, 0.0116822293],
            [-0.0373465053, -0.022596546, 0.003958847, -0.0415607069, -0.0011909358],
            [-0.046047902, -0.028606299, 0.01094916, -0.0489955001, -0.0237719969],
            [-0.0534470496, -0.034222651, 0.01891616, -0.0465878619, -0.038390212],
            [-0.0583779795, -0.03904415, 0.02589318, -0.040057806, -0.0439165814],
            [-0.0597371569, -0.040162385, 0.03161584, -0.0352263691, -0.0427921247],
            [-0.0571977721, -0.035628136, 0.03700254, -0.0296002018, -0.0314716758],
            [-0.050721145, -0.024416561, 0.04424005, -0.0171318853, -0.005454985],
            [-0.0402625978, -0.0040815, 0.05498803, 0.0047933988, 0.0320427902],
            [-0.0255901207, 0.026700872, 0.06897269, 0.0325997951, 0.0627696397],
            [-0.0069535852, 0.060022672, 0.08325015, 0.0674861173, 0.0750819371],
            [0.0157301459, 0.090357444, 0.0893479, 0.097856044, 0.0701984984],
            [0.0410114259, 0.122056876, 0.0813847, 0.1172455269, 0.0586074403],
            [0.0639032885, 0.154599165, 0.06127667, 0.1191099308, 0.0524359187],
            [0.0773158296, 0.175004723, 0.04071865, 0.1103008184, 0.0571533319],
            [0.077895887, 0.17401285, 0.03164864, 0.1013778551, 0.0603112644],
            [0.064957818, 0.14318625, 0.0306274, 0.0823765702, 0.0346626979],
            [0.0405774539, 0.072742113, 0.02919583, 0.0467017878, -0.0373616251],
            [0.0162101859, -0.011428077, 0.01884371, -0.0023472591, -0.1198390536],
            [0.0012814899, -0.076072065, -0.002281165, -0.0491685549, -0.169357725],
            [-0.0033845096, -0.10671719, -0.02895817, -0.0889423107, -0.1697025274],
            [-0.0025551693, -0.10821809, -0.04854639, -0.1054989175, -0.1129504691],
            [-0.0002382727, -0.091882314, -0.05177462, -0.0998399114, -0.043219179],
            [-0.0010565975, -0.070834481, -0.03669841, -0.0763788785, 0.0119713826],
            [-0.0095028058, -0.065918716, -0.0111472, -0.0529704812, 0.0189332996],
            [-0.021756916, -0.070379542, 0.01325369, -0.0437026753, -0.0166032006],
            [-0.0308851017, -0.062419732, 0.03569473, -0.0292545257, -0.0315144345],
            [-0.0355555603, -0.048031982, 0.05206415, -0.0139807927, -0.0215662698],
            [-0.0366949944, -0.034235647, 0.06075533, -0.0005466546, 0.0092145626],
            [-0.0358095414, -0.026902939, 0.059677, 0.0006451073, 0.0314035028],
            [-0.0348045927, -0.027966295, 0.05327137, -0.0030940643, 0.044300105],
            [-0.033786543, -0.03560796, 0.0458226, -0.0102255803, 0.0454047791],
            [-0.0301252153, -0.044259428, 0.03888341, -0.0278714572, 0.0196667351],
            [-0.0190014439, -0.044679641, 0.03717849, -0.036805201, 0.008521681],
            [0.0028983721, -0.045752862, 0.03730737, -0.0400997437, 0.0080578938],
            [0.038766527, -0.049802677, 0.03992511, -0.0471164703, 0.0164330432],
            [0.0913798138, -0.050543209, 0.05396866, -0.0428052043, 0.0425905771],
            [0.1554253141, -0.062748273, 0.08124805, -0.0195276845, 0.0588607383],
            [0.2184605996, -0.095763518, 0.1109858, 0.0203293535, 0.042049592],
            [0.2632006065, -0.147028855, 0.1318394, 0.0732552457, 0.002332687],
            [0.2764944403, -0.205172829, 0.134274, 0.1286126516, -0.0368880188],
            [0.2548888592, -0.254549044, 0.1084618, 0.1594024565, -0.0792129907],
            [0.2034643754, -0.274495, 0.06503745, 0.1549841857, -0.1095217052],
            [0.1356474004, -0.248811705, 0.02402457, 0.1144503991, -0.1211200999],
            [0.0692310929, -0.181034006, 0.00134473, 0.0554733352, -0.1086416493],
            [0.0162257885, -0.091921914, 0.00006780712, 0.0006236463, -0.1109838],
            [-0.0224118069, -0.003745113, 0.01794114, -0.0279055435, -0.1279779774],
            [-0.049801375, 0.064912722, 0.04531234, -0.0302688845, -0.1583378314],
            [-0.0670249943, 0.104752611, 0.0616016, -0.0195391763, -0.1721634296],
            [-0.0761482961, 0.120521813, 0.05807035, -0.0080644355, -0.1617751481],
            [-0.0798577889, 0.117000704, 0.03774134, -0.0044924284, -0.1394618248],
            [-0.078046641, 0.104065211, 0.003210515, -0.0140995852, -0.1059133758],
            [-0.0707440263, 0.08610324, -0.03311872, -0.0078222522, -0.0600676801],
            [-0.059410679, 0.064080389, -0.06511419, 0.0109529424, -0.0556557039],
            [-0.0447731358, 0.042648947, -0.08337773, 0.0446358886, -0.1049610537],
            [-0.0268986934, 0.026384721, -0.08461547, 0.1013526043, -0.1523031555],
            [-0.008829279, 0.013944395, -0.07998647, 0.1480567483, -0.1646065668],
            [0.0054035693, -0.004375208, -0.08053276, 0.1708822429, -0.1351551377],
            [0.0156041629, -0.022382477, -0.08746085, 0.1684728348, -0.068016786],
            [0.0211956112, -0.036225777, -0.0997581, 0.1497838509, 0.0443422028],
            [0.0207553085, -0.051821554, -0.1162756, 0.1129728707, 0.1427496775],
            [0.0155084915, -0.067640179, -0.1295653, 0.0604543702, 0.1695933063],
            [0.0080940162, -0.077330038, -0.1301662, 0.0058635689, 0.1358249266],
            [0.0025906578, -0.063366986, -0.1082072, -0.0221938019, 0.1242855411],
            [-0.0026157959, -0.035770572, -0.07226682, -0.0232218162, 0.1266829189],
            [-0.0077551526, -0.0018186, -0.02654082, -0.0051787071, 0.1328430886],
            [-0.0126880265, 0.037794667, 0.02273443, 0.0237221654, 0.1241062199],
            [-0.0192791832, 0.075716831, 0.06565285, 0.0523065803, 0.0757348869],
            [-0.0267081425, 0.108402668, 0.101632, 0.0809234923, -0.0065824588],
            [-0.0347290346, 0.129472817, 0.1325252, 0.1074486763, -0.0991600375],
            [-0.0467326376, 0.122139423, 0.1412744, 0.1162661463, -0.1750596724],
            [-0.0607264466, 0.096862205, 0.1274396, 0.1132370262, -0.2258964506],
            [-0.0746823613, 0.057360542, 0.0920283, 0.089426683, -0.254001904],
            [-0.0857967372, 0.01721135, 0.04905672, 0.0553036479, -0.2449260088],
            [-0.0944404223, -0.019332691, -0.0009352124, 0.0254404436, -0.2270182304],
            [-0.0976040161, -0.044217916, -0.04538688, 0.0112302568, -0.1517925164],
            [-0.0930266811, -0.066162405, -0.07325798, 0.0127330806, -0.0681817118],
            [-0.0826153817, -0.093524564, -0.1042782, 0.0083553534, -0.0184803979],
            [-0.0613757269, -0.093811693, -0.1358363, 0.0255647638, 0.0281159389],
            [-0.0304501518, -0.059972048, -0.1602326, 0.0816008188, 0.0540665159],
            [-0.0003629197, -0.001148256, -0.1927557, 0.1339126004, 0.0364610867],
            [0.0170313272, 0.043833289, -0.2314117, 0.1846037508, -0.0215888405],
            [0.0205111872, 0.081434444, -0.2380915, 0.267988531, -0.0081098885],
            [0.0073955253, 0.075359084, -0.2367175, 0.2940863182, -0.0090193797],
            [-0.0204329354, 0.015333511, -0.2269116, 0.2341934231, -0.0307931174],
            [-0.0515831837, -0.044355505, -0.2136522, 0.1286993512, 0.0080038775],
            [-0.0830750777, -0.100177206, -0.1924895, 0.0035790367, -0.0226403313],
            [-0.1078793779, -0.136461889, -0.1961337, -0.1191571872, -0.0387444115],
            [-0.1209873211, -0.158447572, -0.2098556, -0.2311886647, -0.0726185357],
        ];

        // When
        $W = self::$pls->getXLoadings()->getMatrix();

        // Then
        $this->assertEqualsWithDelta($expected, $W, .00001, '');
    }

    /**
     *  The class returns the correct values for B
     *
     * R code for expected values:
     *   pls.model$B
     */
    public function DoNotTestB()
    {
        // Given
        $expected = [
            [3820.6775, 21.3245647, 2.33227102, -13.51685507, 98.5059578, -13.20580253],
            [1068.27579, 23.7533401, 7.94141895, -11.61016324, 101.8645483, -17.91653334],
            [-848.55149, 24.7703036, 11.94896631, -8.46816333, 94.3451403, -20.1426379],
            [-516.82507, 25.0311815, 12.12141159, -6.58690139, 89.2525983, -19.44084884],
            [446.9188, 24.7726867, 11.34454326, -3.8573071, 77.3898391, -17.25594415],
            [1978.94713, 23.8270929, 8.96699878, -2.88594261, 70.0477063, -14.40283522],
            [4005.55731, 22.8425035, 5.37943791, -3.8774758, 69.9118454, -11.49267927],
            [6215.07705, 21.3959308, 0.9072223, -6.33251443, 72.572799, -8.38811642],
            [5618.87361, 15.2534947, -1.60202541, -6.74781487, 56.7875666, -4.99890932],
            [70.25341, 2.6816788, 0.94102954, -1.08340854, 1.4775253, -1.51927706],
            [-7346.26134, -13.1195437, 4.76518975, 5.92774921, -62.9519311, 2.04810267],
            [-13754.03848, -26.0098398, 8.62654233, 12.57678378, -118.1385663, 4.74944591],
            [-17087.99066, -32.5526192, 10.64297989, 15.73026649, -145.2778675, 5.96496961],
            [-15868.01222, -31.1651501, 9.13989676, 13.6582761, -134.8260987, 5.98006199],
            [-11272.00838, -23.9744536, 5.08957834, 8.11026022, -98.2568667, 5.27221052],
            [-5516.0748, -14.7342827, 0.25365525, 1.59590708, -53.2083642, 4.32727735],
            [-1704.68539, -7.6905373, -2.22973124, -1.7572817, -25.9074771, 3.41718382],
            [150.40358, -4.0051502, -3.21439043, -3.05038497, -12.9548038, 2.88190608],
            [311.83867, -3.4201119, -3.12688469, -3.05464343, -10.7868519, 2.65138321],
            [465.14068, -3.3831016, -3.52639685, -3.89994726, -6.3960544, 2.52450128],
            [611.26046, -2.6992613, -3.64828463, -4.99195054, -0.2228959, 1.92414367],
            [-40.28268, -2.0276546, -2.35766646, -4.87703848, 1.9007127, 0.67895964],
            [-1031.6046, -0.8143798, -0.22468119, -4.4082128, 3.8288259, -1.22624119],
            [-1994.48017, 1.5425536, 2.60782434, -3.37529191, 6.1028094, -3.68268043],
            [-2665.42349, 5.2881487, 6.05866203, -1.1474211, 6.2634007, -6.32111205],
            [-1984.79763, 10.197283, 8.16813665, 0.78210935, 10.2571886, -8.16812764],
            [587.0965, 16.1412849, 7.88139633, 1.48513314, 21.0145558, -8.73162662],
            [3941.59512, 22.1360762, 6.3715316, 1.56972753, 33.4155984, -8.51624133],
            [7494.89545, 27.4517728, 3.90851087, 0.42697425, 47.8732465, -7.9107587],
            [10635.96622, 31.3497455, 1.03932717, -1.5968422, 60.9957404, -7.02494884],
            [12382.46344, 33.5570335, -0.81406893, -3.68036803, 68.2810888, -6.56696238],
            [11711.12358, 33.3912377, -0.27109241, -4.64320295, 65.4727855, -7.06908753],
            [9794.27716, 32.4258356, 1.94727635, -4.32087602, 60.0235999, -8.35909847],
            [7885.29659, 32.1080331, 5.29760158, -1.15077832, 53.5072843, -9.69821716],
            [5496.18864, 31.0789788, 9.71141126, 4.6334171, 46.3778286, -11.06286066],
            [4532.7109, 29.5190756, 11.04609815, 6.83697706, 61.5930838, -12.03219718],
            [4233.67964, 25.6316373, 9.51613719, 6.05534473, 86.5786622, -11.83608733],
            [1723.17122, 17.4255719, 9.09904889, 6.78214065, 86.5323867, -10.59938623],
            [-2026.54905, 6.8286355, 8.92842623, 7.21628933, 65.7788373, -8.49244627],
            [-5113.64187, -3.1570142, 7.34280603, 4.98920425, 41.8364703, -5.91412784],
            [-5997.63379, -9.058769, 4.52039685, 1.91112336, 20.0002012, -2.9886392],
            [-4701.29431, -9.8304346, 1.6370712, 0.12034601, 0.1977058, -0.1433276],
            [168.75449, -5.0586945, -3.77797501, -3.61896081, 3.6692313, 2.65786882],
            [6210.66517, 1.8838642, -9.8315126, -8.18397436, 22.4236627, 4.8121196],
            [9649.47094, 6.1368124, -12.89536838, -9.91642704, 30.8356199, 6.03805887],
            [10119.17257, 7.4765568, -12.59764677, -8.80986346, 26.1708128, 6.16182491],
            [7697.33928, 5.5169308, -9.75862133, -6.89291334, 16.1680717, 4.8998329],
            [3713.13157, 1.3848031, -6.17576459, -6.24385385, 10.0650798, 2.5984201],
            [-446.37306, -2.8354347, -2.66311262, -6.67174504, 8.83625, -0.20974278],
            [-3678.19169, -6.0427284, 0.01709768, -7.43579528, 12.348778, -2.70682123],
            [-6596.41384, -8.8044332, 2.75070915, -7.16417905, 11.8233927, -4.74451632],
            [-8139.64434, -10.2394944, 4.30057106, -6.68911631, 10.9863686, -5.76614386],
            [-7756.28118, -9.9321339, 3.90504986, -6.85688966, 14.2879307, -5.6387654],
            [-6494.87375, -8.6770837, 2.80866868, -6.83500102, 16.0281554, -4.84623424],
            [-5569.73064, -7.7375953, 2.15725687, -6.12329686, 10.791114, -3.85684802],
            [-4790.14114, -7.0292124, 1.61201343, -5.22331108, 1.7694056, -2.70678101],
            [-4561.65515, -6.9153294, 1.74956835, -3.4173553, -12.346689, -1.5742924],
            [-5626.43395, -8.4399105, 3.0709348, -0.68714827, -32.6621709, -0.73513255],
            [-7491.28092, -10.6419808, 5.5163856, 3.4801539, -59.9031434, -0.01586641],
            [-8470.30709, -12.472654, 6.72071218, 6.72296945, -79.629199, 1.10419737],
            [-8800.62357, -13.864767, 6.89550981, 8.48287732, -90.492556, 2.18494481],
            [-8499.76476, -14.1481788, 6.43784373, 8.9487044, -94.3677335, 2.96478035],
            [-7050.73807, -12.7655622, 4.81143404, 7.69238352, -88.4592787, 3.58652895],
            [-3798.92054, -9.3419983, 1.21913995, 4.35352888, -69.8544819, 4.46065644],
            [1619.46918, -3.2317528, -4.31380312, -0.2916735, -40.7212709, 5.86209291],
            [8542.94755, 5.7893054, -10.0210178, -3.32479247, -13.2051207, 7.75885067],
            [15594.96515, 15.7345261, -14.5500065, -3.02300123, 5.9131481, 10.05496528],
            [21309.06558, 25.0515571, -17.0004215, -0.72034123, 20.4195654, 11.47532185],
            [26010.42898, 34.6851895, -17.9620827, 1.13103343, 41.5567646, 11.06142524],
            [29662.40023, 44.1425294, -18.20606946, 0.46928657, 72.0577095, 8.70076376],
            [31466.63215, 49.8954343, -18.39791052, -2.39116491, 101.0104569, 5.96357598],
            [30731.40397, 49.5607208, -17.94470755, -3.99861408, 108.7859123, 4.67334848],
            [24883.30988, 40.7435108, -13.52170148, -0.43560436, 75.5120732, 4.38812765],
            [11605.86932, 20.9740804, -2.65487691, 10.25966823, -6.4523707, 4.19641589],
            [-4616.66631, -2.4647288, 10.54417142, 21.45469156, -94.6241407, 2.77667862],
            [-17386.04831, -20.3368879, 20.2556881, 26.28163245, -142.7857473, -0.14742231],
            [-24000.19129, -28.8692526, 24.1241326, 22.66546676, -139.5746953, -4.11119519],
            [-23652.62121, -29.2586741, 20.48350783, 10.91657473, -89.6106715, -7.19357481],
            [-19063.52582, -24.7316812, 13.47682144, -0.8237585, -34.6074497, -8.01270183],
            [-13014.10487, -18.9847141, 6.2166351, -7.93411462, -0.3989021, -6.17990731],
            [-10401.0422, -17.8620966, 3.58195938, -6.0682524, -13.7455608, -2.7088168],
            [-11218.52907, -19.6686018, 5.82619067, 2.34318219, -61.2489303, 0.54514301],
            [-9576.3343, -18.0399787, 5.57460069, 7.32343036, -87.7492457, 3.50895154],
            [-6353.30901, -14.4530557, 2.98271541, 7.63775328, -89.2820565, 5.6020148],
            [-2727.08327, -10.76512, -1.1587019, 3.7194973, -69.9645087, 6.65417615],
            [-1043.77265, -8.7947465, -3.43325213, -0.03587551, -51.9433057, 6.34642349],
            [-1090.76716, -9.0108912, -4.18341724, -2.87799635, -38.7595956, 5.44727316],
            [-2528.09687, -10.9626841, -3.45244753, -3.96717096, -35.0737098, 4.45962157],
            [-5466.62828, -13.3031862, 0.18815788, -0.89363104, -51.8158827, 3.3261773],
            [-6131.12655, -13.0066396, 1.59778904, 0.4430295, -57.1468982, 2.82702842],
            [-5886.74289, -12.1690148, 1.66371871, 0.25464032, -52.9608981, 2.57860092],
            [-5445.18538, -11.3842769, 1.03965497, -1.44598543, -43.5311421, 2.30228079],
            [-2635.91272, -8.6653804, -2.3136757, -4.89053132, -24.5306947, 3.3462811],
            [149.69296, -7.9310442, -5.7847927, -5.03108133, -18.9842133, 6.56567376],
            [226.22429, -12.2440462, -6.43282932, 1.0943118, -38.5820738, 11.11196291],
            [-2725.82394, -21.873796, -4.61218512, 10.83727844, -71.1223135, 15.70505325],
            [-7727.27467, -34.7716264, -1.91239067, 19.2365958, -95.9403779, 18.77159156],
            [-14827.23819, -47.687592, 3.06814638, 25.21744508, -110.4430687, 18.19674784],
            [-21135.5211899999, -55.3928816, 8.4043409, 26.80352979, -110.5028119, 14.33718152],
            [-23577.65473, -53.2114088, 12.26322317, 24.48164864, -102.4070978, 8.92988546],
            [-20532.48595, -40.7994572, 12.81606998, 19.15756191, -88.641305, 4.14589484],
            [-14254.58543, -22.4036192, 12.99705756, 18.23412974, -93.4833072, 1.56145641],
            [-6287.80523, -3.1077902, 12.56110366, 22.17612325, -114.4756007, 1.97010992],
            [825.42937, 12.3236686, 12.36811113, 29.91297342, -147.9947336, 4.54211287],
            [5677.85816, 21.4434421, 11.33066652, 34.22506149, -162.2741071, 6.51760831],
            [8138.68044, 25.156323, 9.47178327, 32.69462846, -146.9721366, 6.44399538],
            [7935.95517, 24.3012886, 8.07028885, 27.3763906, -114.6703018, 4.37660765],
            [6028.89961, 21.2380846, 7.01710231, 18.45455476, -66.8929717, 0.30279814],
            [4841.63067, 17.5546903, 4.28503721, 7.80633911, -4.9213478, -3.44142607],
            [2610.98395, 13.1673661, 4.63828782, 4.85918325, 29.6952725, -5.92854081],
            [-136.16107, 9.1670008, 8.61773001, 12.56842844, 22.1123432, -6.04028289],
            [-412.03822, 6.992432, 10.58783085, 22.16537965, 8.9262353, -3.60914678],
            [663.7268, 5.670872, 9.59169844, 26.04732873, 11.2774904, -1.27192857],
            [1022.12967, 2.3718112, 6.40299995, 21.68078326, 35.9607716, -0.63494715],
            [1140.20724, -1.400616, 1.27246451, 9.62086434, 82.777053, -1.89086465],
            [2205.83534, -4.5296625, -7.06760869, -10.98758563, 159.1563868, -4.68148298],
            [1375.14317, -8.7805276, -13.0486827, -30.19367187, 223.1395075, -8.43050697],
            [-2779.46782, -13.8608301, -11.91941315, -37.62718981, 231.9756051, -11.84592874],
            [-8068.48303, -17.7975518, -5.84767566, -33.85977114, 190.3853472, -13.5955796],
            [-7681.0706, -15.2622363, -4.57323128, -30.94945923, 157.0747102, -12.40678832],
            [-3376.57971, -8.8201608, -6.75437104, -28.23136758, 131.4873997, -8.97909036],
            [3089.87545, -0.461647, -10.71248883, -24.64656286, 106.5284817, -3.9036323],
            [10376.51613, 9.466752, -14.16874423, -17.87546427, 73.3918059, 2.02058993],
            [15827.39531, 18.7915779, -13.79754065, -4.99615163, 19.4671679, 7.62261667],
            [19241.35885, 26.6968168, -9.98932038, 12.98284911, -51.7099021, 12.83458025],
            [20645.42958, 31.6228134, -4.59616951, 32.15013634, -128.8689958, 17.62743688],
            [17571.63933, 29.0564018, 1.85566947, 45.98602398, -188.8878609, 19.60543619],
            [11878.18241, 21.8528829, 7.96443869, 53.26607608, -220.7610625, 18.78119946],
            [3552.9612, 10.8704972, 14.19360048, 54.15710837, -227.8803654, 14.89047478],
            [-4251.6004, -0.1739062, 17.82254036, 47.79787162, -206.2874876, 9.52208539],
            [-11270.6036, -10.0489641, 20.52291183, 39.50445535, -169.578697, 3.48135544],
            [-13816.54938, -16.2837331, 16.71908466, 22.59653402, -91.6585689, -1.98317262],
            [-14203.41512, -21.1251499, 10.74132034, 6.17073437, -16.2858279, -5.29346182],
            [-16658.5111, -27.2030141, 8.32287762, -5.09406406, 38.3937606, -8.87590249],
            [-14677.59275, -25.5413043, 4.12513199, -15.13804554, 108.2830998, -11.95987834],
            [-6945.78576, -14.2012145, -1.58556421, -19.7486526, 181.5016444, -13.00921641],
            [1752.3969, 3.1742872, -3.84046628, -17.78111971, 239.8464695, -14.88634682],
            [6817.02854, 16.2941132, -1.62878654, -9.55259285, 269.9063945, -16.93135499],
            [15823.59326, 27.5064635, -8.00100353, -9.42731549, 320.1722605, -14.86809703],
            [16113.31959, 25.769971, -8.90715544, -8.18779377, 320.5208553, -13.58378135],
            [4853.10819, 8.0595768, -2.04836449, -5.7453704, 255.8194324, -14.01350089],
            [-6551.17902, -10.4401169, 1.49882584, -14.70833709, 213.3531383, -16.29514219],
            [-20660.37132, -28.597504, 11.83617861, -12.01470893, 114.0203457, -17.99529003],
            [-32463.94922, -41.320372, 20.7731916, -13.757328, 55.0818507, -22.46506658],
            [-42682.63888, -49.6527701, 30.49878343, -13.04302072, 4.2000163, -27.61264177],
        ];

        // When
        $B = self::$pls->getCoefficients()->getMatrix();

        // Then
        $this->assertEqualsWithDelta($expected, $B, .00001, '');
    }
}
